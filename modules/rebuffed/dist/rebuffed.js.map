{"version":3,"file":"rebuffed.js","mappings":";AAAO,MAAMA,UAAuB,gBAAgB;AAAA,EAEhD,WAAW,iBAAiB;AACxB,WAAO,QAAQ,MAAM,YAAY,MAAM,gBAAgB;AAAA,MACnD,OAAO,KAAK,KAAK,SAAS,sBAAsB;AAAA,MAChD,IAAI;AAAA,MACJ,UAAU;AAAA,MACV,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,eAAe;AAAA,IAC3B,CAAS;AAAA,EACJ;AACL;ACTA,MAAM,KAAK,QAAQ,YAAY;AAC3B,UAAQ,IAAI,cAAc,uBAAuBC,CAAO,EAAE,GAE1D,KAAK,SAAS,SAAS,YAAY,oBAAoB;AAAA,IACnD,MAAM;AAAA,IACN,MAAM;AAAA,IACN,OAAO;AAAA,IACP,MAAM;AAAA,IACN,SAAS;AAAA,IACT,QAAQ;AAAA,EAChB,CAAK,GAED,KAAK,SAAS,aAAa,YAAY,qBAAqB;AAAA,IACxD,MAAM;AAAA,IACN,OAAO;AAAA,IACP,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAMD;AAAA,EACd,CAAK;AACL,CAAC;AAED,MAAM,KAAK,SAAS,YAAY;AAC5B,UAAQ,IAAI,cAAc,mBAAmB;AACjD,CAAC;AAED,MAAME,IAAe,CAAC,UAAU,mBAAmB,GAE7CC,IAAiB,OAAOC,MAAW;AAErC,MAAI,CAAC,KAAK,SAAS,IAAI,YAAY,kBAAkB,GAAG;AACpD,YAAQ,IAAI,cAAc,oBAAoB;AAE9C;AAAA,EACH;AAED,QAAMC,IAAYD,EAAO,WACnBE,IAAc,KAAK,MAAM;AAE/B,MAAI,CAACD;AACD;AAGJ,QAAME,IAAQF,EAAU;AAExB,MAAKE,KAIDA,EAAM,aAAaD,CAAW,MAAM,MAAM,0BAA0B,OAIxE;AAAA,YAAQ,IAAI,cAAc,qBAAqBC,EAAM,MAAMA,CAAK;AAEhE,eAAWC,KAAcD,EAAM,aAAa,aAAa;AAErD,cAAQ,MAAM,cAAc,oBAAoBC,CAAU;AAE1D,iBAAWC,KAASD,EAAW,MAAM;AACjC,gBAAQ,IAAI,cAAc,SAASC,CAAK,GAEpCP,EAAa,SAASO,EAAM,IAAI,MAChC,QAAQ,IAAI,cAAc,oBAAoB,GAC9C,GAAG,cAAc,KAAK,MAAM,WAAW,WAAW,8BAA8BA,EAAM,IAAI,KAAKA,EAAM,IAAI,GAAG,CAAC;AAAA,IAGxH;AAAA;AACL;AAEA,MAAM,GAAG,oBAAoBN,CAAc;","names":["RebuffedConfig","version","wantedSpells","onCombatUpdate","combat","combatant","currentUser","actor","collection","spell"],"sources":["../scripts/RebuffedConfig.js","../scripts/module.js"],"sourcesContent":["export class RebuffedConfig extends FormApplication {\n\n    static get defaultOptions() {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            title: game.i18n.localize(\"REBUFFED.configTitle\"),\n            id: \"rebuffed-config\",\n            template: \"modules/rebuffed/templates/rebuffed-config.html\",\n            width: 650,\n            height: \"auto\",\n            closeOnSubmit: true,\n        })\n    }\n}\n","import { version } from '../package.json'\nimport { RebuffedConfig } from './RebuffedConfig'\n\nHooks.once('init', async () => {\n    console.log('[REBUFFED]', `Launching Rebuffed v${version}`)\n\n    game.settings.register(\"rebuffed\", \"rebuffed-enabled\", {\n        name: \"REBUFFED.enabled\",\n        hint: \"REBUFFED.enabledHint\",\n        scope: \"client\",\n        type: Boolean,\n        default: true,\n        config: true,\n    })\n\n    game.settings.registerMenu(\"rebuffed\", \"rebuffed-settings\", {\n        name: \"REBUFFED.config\",\n        label: \"REBUFFED.configTitle\",\n        hint: \"REBUFFED.configHint\",\n        icon: \"fas fa-repeat\",\n        type: RebuffedConfig,\n    })\n})\n\nHooks.once('ready', async () => {\n    console.log('[REBUFFED]', 'Launched Rebuffed')\n})\n\nconst wantedSpells = ['Shield', 'Courageous Anthem']\n\nconst onCombatUpdate = async (combat) => {\n\n    if (!game.settings.get('rebuffed', 'rebuffed-enabled')) {\n        console.log('[REBUFFED]', 'Currently disabled')\n\n        return;\n    }\n\n    const combatant = combat.combatant;\n    const currentUser = game.users.current\n\n    if (!combatant) {\n        return\n    }\n\n    const actor = combatant.actor\n\n    if (!actor) {\n        return\n    }\n\n    if (actor.getUserLevel(currentUser) !== CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER) {\n        return;\n    }\n\n    console.log('[REBUFFED]', 'Current Combatant', actor.name, actor)\n\n    for (const collection of actor.spellcasting.collections) {\n\n        console.debug('[REBUFFED]', 'spell collection', collection)\n\n        for (const spell of collection.entry.spells) {\n            console.log('[REBUFFED]', 'spell', spell)\n\n            if (wantedSpells.includes(spell.name)) {\n                console.log('[REBUFFED]', 'Found wanted spell')\n                ui.notifications.info(await TextEditor.enrichHTML(`Don't forget to cast @UUID[${spell.uuid}]{${spell.name}}`))\n            }\n        }\n    }\n}\n\nHooks.on(\"combatTurnChange\", onCombatUpdate);\n"]}